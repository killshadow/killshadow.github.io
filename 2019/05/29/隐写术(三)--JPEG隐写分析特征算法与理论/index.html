<!DOCTYPE html>
<html>
<head>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="utf-8">
  
  <title>隐写术(三)--JPEG隐写分析特征算法与理论 | Live to change world</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="0x00 前言  前面介绍的内容着重于阐述传统的数字图像隐写算法，实际上与图像隐写对立的数字图像隐写分析，而这一方向也随着图像隐写的发展而发展，形成一种对抗的博弈。数字图像隐写分析分类如下图所示:">
<meta name="keywords" content="CTF,MISC">
<meta property="og:type" content="article">
<meta property="og:title" content="隐写术(三)--JPEG隐写分析特征算法与理论">
<meta property="og:url" content="http://www.killshadow.xyz/2019/05/29/隐写术(三)--JPEG隐写分析特征算法与理论/index.html">
<meta property="og:site_name" content="Live to change world">
<meta property="og:description" content="0x00 前言  前面介绍的内容着重于阐述传统的数字图像隐写算法，实际上与图像隐写对立的数字图像隐写分析，而这一方向也随着图像隐写的发展而发展，形成一种对抗的博弈。数字图像隐写分析分类如下图所示:">
<meta property="og:locale" content="default">
<meta property="og:image" content="http://www.killshadow.xyz/2019/05/29/隐写术(三)--JPEG隐写分析特征算法与理论/8343187-9cfd3b1c3aa58b1b.png">
<meta property="og:image" content="http://www.killshadow.xyz/2019/05/29/隐写术(三)--JPEG隐写分析特征算法与理论/1559128502282.png">
<meta property="og:image" content="http://www.killshadow.xyz/2019/05/29/隐写术(三)--JPEG隐写分析特征算法与理论/1559130220786.png">
<meta property="og:updated_time" content="2019-06-04T10:31:24.580Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="隐写术(三)--JPEG隐写分析特征算法与理论">
<meta name="twitter:description" content="0x00 前言  前面介绍的内容着重于阐述传统的数字图像隐写算法，实际上与图像隐写对立的数字图像隐写分析，而这一方向也随着图像隐写的发展而发展，形成一种对抗的博弈。数字图像隐写分析分类如下图所示:">
<meta name="twitter:image" content="http://www.killshadow.xyz/2019/05/29/隐写术(三)--JPEG隐写分析特征算法与理论/8343187-9cfd3b1c3aa58b1b.png">
  
    <link rel="alternative" href="/atom.xml" title="Live to change world" type="application/atom+xml">
  
  
    <link rel="icon" href="//assets/img/wolf_track.ico">
  
  
      <link rel="stylesheet" href="//cdn.bootcss.com/animate.css/3.5.0/animate.min.css">
  
  <link rel="stylesheet" href="/css/style.css">
  <link rel="stylesheet" href="/font-awesome/css/font-awesome.min.css">
  <link rel="apple-touch-icon" href="/apple-touch-icon.png">
  
  
      <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  
  <!-- 加载特效 -->
    <script src="/js/pace.js"></script>
    <link href="/css/pace/pace-theme-flash.css" rel="stylesheet" />
  <script>
      var yiliaConfig = {
          rootUrl: '/',
          fancybox: true,
          animate: true,
          isHome: false,
          isPost: true,
          isArchive: false,
          isTag: false,
          isCategory: false,
          open_in_new: false
      }
  </script><!-- hexo-inject:begin --><!-- hexo-inject:end -->
</head>
<body>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><div id="container">
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
    <header id="header" class="inner">
        <script src="http://7.url.cn/edu/jslib/comb/require-2.1.6,jquery-1.9.1.min.js"></script>
        <a href="/" class="profilepic">
            
            <img lazy-src="/assets/img/head.png" class="js-avatar">
            
        </a>
        <hgroup>
          <h1 class="header-author"><a href="/">killshadow</a></h1>
        </hgroup>
        
        
            <form>
                <input type="text" class="st-default-search-input search" id="local-search-input" placeholder="搜索一下" autocomplete="off">
            </form>
            <div id="local-search-result"></div>
        
        
            <script type="text/javascript">
                (function() {
                    'use strict';
                    function getMatchData(keyword, data) {
                        var matchData = [];
                        for(var i =0;i<data.length;i++){
                            if(data[i].title.toLowerCase().indexOf(keyword)>=0) 
                                matchData.push(data[i])
                        }
                        return matchData;
                    }
                    var $input = $('#local-search-input');
                    var $resultContent = $('#local-search-result');
                    $input.keyup(function(){
                        $.ajax({
                            url: '/search.json',
                            dataType: "json",
                            success: function( json ) {
                                var str='<ul class=\"search-result-list\">';                
                                var keyword = $input.val().trim().toLowerCase();
                                $resultContent.innerHTML = "";
                                if ($input.val().trim().length <= 0) {
                                    $resultContent.empty();
                                    $('#switch-area').show();
                                    return;
                                }
                                var results = getMatchData(keyword, json);
                                if(results.length === 0){
                                    $resultContent.empty();
                                    $('#switch-area').show();
                                    return;
                                } 
                                for(var i =0; i<results.length; i++){
                                    str += "<li><a href='"+ results[i].url +"' class='search-result-title'>"+ results[i].title +"</a></li>";
                                }
                                str += "</ul>";
                                $resultContent.empty();
                                $resultContent.append(str);
                                $('#switch-area').hide();
                            }
                        });
                    });
                })();
            </script>
        
        
            <div id="switch-btn" class="switch-btn">
                <div class="icon">
                    <div class="icon-ctn">
                        <div class="icon-wrap icon-house" data-idx="0">
                            <div class="birdhouse"></div>
                            <div class="birdhouse_holes"></div>
                        </div>
                        <div class="icon-wrap icon-ribbon hide" data-idx="1">
                            <div class="ribbon"></div>
                        </div>
                        
                        
                        <div class="icon-wrap icon-me hide" data-idx="3">
                            <div class="user"></div>
                            <div class="shoulder"></div>
                        </div>
                        
                    </div>
                </div>
                <div class="tips-box hide">
                    <div class="tips-arrow"></div>
                    <ul class="tips-inner">
                        <li>菜单</li>
                        <li>标签</li>
                        
                        
                        <li>关于我</li>
                        
                    </ul>
                </div>
            </div>
        
        <div id="switch-area" class="switch-area">
            <div class="switch-wrap">
                <section class="switch-part switch-part1">
                    <nav class="header-menu">
                        <ul>
                        
                            <li><a  href="http://www.killshadow.xyz/">博客首页</a></li>
                        
                            <li><a  href="/archives">文章归档</a></li>
                        
                        </ul>
                    </nav>
                    <nav class="header-nav">
                        <ul class="social">
                            
                                <a class="fl github"  target="_blank" href="https://www.github.com/killshadow" title="github">github</a>
                            
                                <a class="fl zhihu"  target="_blank" href="https://www.zhihu.com/people/0038/" title="zhihu">zhihu</a>
                            
                        </ul>
                    </nav>
                </section>
                
                <section class="switch-part switch-part2">
                    <div class="widget tagcloud" id="js-tagcloud">
                        <a href="/tags/Android-Developer/" style="font-size: 13.33px;">Android Developer</a> <a href="/tags/CTF/" style="font-size: 20px;">CTF</a> <a href="/tags/Deep-Learning/" style="font-size: 10px;">Deep Learning</a> <a href="/tags/MISC/" style="font-size: 16.67px;">MISC</a> <a href="/tags/Mobile-Security/" style="font-size: 10px;">Mobile Security</a> <a href="/tags/PWN/" style="font-size: 10px;">PWN</a> <a href="/tags/Reverse/" style="font-size: 10px;">Reverse</a> <a href="/tags/Wireless/" style="font-size: 10px;">Wireless</a>
                    </div>
                </section>
                
                
                
                
                <section class="switch-part switch-part3">
                
                    <div id="js-aboutme">潜心修行，勿忘初心</div>
                </section>
                
            </div>
        </div>
    </header>
</div>

    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
      <div class="overlay">
          <div class="slider-trigger"></div>
          <h1 class="header-author js-mobile-header hide"><a href="/" title="Me">killshadow</a></h1>
      </div>
    <div class="intrude-less">
        <header id="header" class="inner">
            <a href="/" class="profilepic">
                
                    <img lazy-src="//assets/img/head.png" class="js-avatar">
                
            </a>
            <hgroup>
              <h1 class="header-author"><a href="/" title="Me">killshadow</a></h1>
            </hgroup>
            
            <nav class="header-menu">
                <ul>
                
                    <li><a href="http://www.killshadow.xyz/">博客首页</a></li>
                
                    <li><a href="/archives">文章归档</a></li>
                
                <div class="clearfix"></div>
                </ul>
            </nav>
            <nav class="header-nav">
                <div class="social">
                    
                        <a class="github" target="_blank" href="https://www.github.com/killshadow" title="github">github</a>
                    
                        <a class="zhihu" target="_blank" href="https://www.zhihu.com/people/0038/" title="zhihu">zhihu</a>
                    
                </div>
            </nav>
        </header>                
    </div>
</nav>
      <div class="body-wrap"><article id="post-隐写术(三)--JPEG隐写分析特征算法与理论" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2019/05/29/隐写术(三)--JPEG隐写分析特征算法与理论/" class="article-date">
      <time datetime="2019-05-29T12:28:00.000Z" itemprop="datePublished">2019-05-29</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      隐写术(三)--JPEG隐写分析特征算法与理论
    </h1>
  

      </header>
      
      <div class="article-info article-info-post">
        

        
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/CTF/">CTF</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/MISC/">MISC</a></li></ul>
    </div>

        <div class="clearfix"></div>
      </div>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <h2 id="x00-前言">0x00 前言</h2>
<blockquote>
前面介绍的内容着重于阐述传统的数字图像隐写算法，实际上与图像隐写对立的数字图像隐写分析，而这一方向也随着图像隐写的发展而发展，形成一种对抗的博弈。数字图像隐写分析分类如下图所示:<a id="more"></a>
<div style="text-align: center;">

</div></blockquote>
<figure>
<img src="/2019/05/29/隐写术(三)--JPEG隐写分析特征算法与理论/8343187-9cfd3b1c3aa58b1b.png" alt="隐写分析算法分类"><figcaption>隐写分析算法分类</figcaption>
</figure>

<p>​ 下面会介绍三个重要的隐写分析算法以展开隐写分析的研究，而这三个算法属于通用盲检测算法范畴，此类算法根据JPEG图像的像素点或者DCT系数的特性，提取出JPEG图像的共生矩和直方图特征，利用这些特征作为分类器的输入，分类器根据这些特征训练可得到检测器，以检测图片是否嵌入了秘密信息。</p>
<blockquote>
<p>若hexo解析公式不正常, <a href="https://www.jianshu.com/p/e75b4baa93f1" target="_blank" rel="noopener">请转移到简书看</a></p>
</blockquote>
<hr>
<h2 id="x10-残差图像的离散余弦变换">0x10 残差图像的离散余弦变换</h2>
<p>残差图像的离散余弦变换（DCTR）[1]是通用的盲检测算法。该算法用JPEG中的DCT基来获得残差直方图，因此特征提取只需要计算64个8x8核DCT基，利用这些卷积核与解压JPEG图像卷积得到一个二维矩阵，然后将这个二维矩阵量化、截断得到子图像，最后根据这些子图像提取出直方图特征，再将这些直方图特征通过对称性原则对其进一步压缩，融合成8000维的特征向量。DCTR较于一般的通用盲检测算法，最大的优势在于效率非常高，提取出的特征的维数也相对较低，本小节将详细解释DCTR的每个步骤。</p>
<p>给定一个像素为 <span class="math inline">\(M × N\)</span>（M,N均为8的倍数）的灰度图像，<span class="math inline">\(\mathrm{X} \in \mathrm{R}^{\mathrm{M} \times \mathrm{N}}\)</span>, 64个<span class="math inline">\(8 × 8\)</span>非抽取的DCT基定义为<span class="math inline">\(B^{(k,l)}\)</span>，则有： <span class="math display">\[
\begin{split}
\mathrm{U}^{(\mathrm{k}, \mathrm{I})}&amp;=\mathrm{X} \star \mathrm{B}^{(\mathrm{k} 1)}\\
\,{u(\mathrm{X})}&amp;=\mathrm{U}^{(\mathrm{k}, 1)} | 0 \leq \mathrm{k}, 1 \leq 7
\end{split}
\tag{1}
\]</span></p>
<p>其中，<span class="math inline">\(\mathrm{U}^{(\mathrm{k}, 1)} \in \mathrm{R}^{(\mathrm{M}-\overline{7}) \times(\mathrm{N}-7)}\)</span>，“<span class="math inline">\(\star\)</span>”表示无填充卷积。为提高可读性，定义<span class="math inline">\(i,j\)</span>和<span class="math inline">\(k,l\)</span>为DCT模型下空域的索引，即像素点的下标，他们的取值范围为<span class="math inline">\({i, j, k, l \in[0,7]}\)</span>。经过上面这一步，我们会得到多个 的矩阵，下面我们会看到未抽样DCT的值<span class="math inline">\(u(X)\)</span>是如何受<span class="math inline">\(X\)</span>的单个DCT系数细微的改变而发生巨大的影响的。</p>
<p>假设二次采样后每<span class="math inline">\(8 × 8\)</span>的矩阵为<span class="math inline">\(\mathrm{U}^{(\mathrm{i}, \mathrm{j})}=\mathrm{X} \star \mathrm{B}^{(\mathrm{i}, \mathrm{j})}\)</span>，这些矩阵的四个顶点为： <span class="math display">\[
\begin{equation}
\mathcal{G}_{8 \times 8}=\{0,7,15, \ldots, \mathrm{M}-9\} \times\{0,7,15, \ldots, \mathrm{N}-9\}
\end{equation}
\tag{2}
\]</span></p>
<p><span class="math inline">\((m, n) \in \mathcal{G}_{8\times 8}\)</span>是对应的JPEG图像上的一个修改的系数，这个系数存在于<span class="math inline">\((k,l)\)</span>矩阵中。<span class="math inline">\((m,n)\)</span>位置上DCT系数的变化将影响一整块<span class="math inline">\(8 × 8\)</span>矩阵中的所有像素，以及在<span class="math inline">\(\mathbf{U}^{(\mathbf{i}, \mathbf{j})}\)</span>中以<span class="math inline">\((m, n) \in \mathcal{G}_{8 \times 8}\)</span>这个点为中心的整个15 × 15的领域。特别地，这些值的修改有下面的“单元响应” <span class="math inline">\(\mathbf{R}^{(\mathbf{i}, \mathbf{j})(\mathbf{k}, \mathbf{l})}\)</span>来完成： <span class="math display">\[
\mathrm{R}^{(\mathrm{i}, \mathrm{j})(\mathrm{k}, 1)}=\mathrm{B}^{(\mathrm{i}, \mathrm{j})} \otimes \mathrm{B}^{(\mathrm{k}, 1)}
\tag{3}
\]</span> 由公式<span class="math inline">\((3)\)</span>假设我们已知某个二次采样后的<span class="math inline">\(8 × 8\)</span>矩阵的四个顶点分别定义为：A、B、C、D，对于一个特定的值<span class="math inline">\(u \in \mathrm{U}^{(\mathrm{i}, \mathrm{j})}\)</span>，即<span class="math inline">\(u\)</span>为<span class="math inline">\(8 × 8\)</span>矩阵中的其中一个元素，它的位置为<span class="math inline">\((a,b)\)</span>，<span class="math inline">\(a, b \in [0,7]\)</span>. 我们以8x8左上角的顶点为参照点，则其他B-D的点分别为：<span class="math inline">\((a,b-8), (a-8,b), (a-8,b-8)\)</span>，这个8x8的矩阵为构成为量化DCT系数的<span class="math inline">\(\mathcal{A}\)</span>块。并设定<span class="math inline">\(\mathcal{A}\)</span>块右、下、右下的8x8块分别为<span class="math inline">\(\mathcal{A}, \mathcal{B}, \mathcal{C}, \mathcal{D}\)</span>区域，则分别有四个矩阵：<span class="math inline">\(A_{k l}, B_{k 1}, C_{k l}, D_{k l}\)</span>，<span class="math inline">\((k,l)\)</span>分别表示横向和纵向的空域坐标轴的位置，由上所述可得： <span class="math display">\[
u=\sum_{k=0}^{7} \sum_{l=0}^{7} Q_{k l}\left[A_{k l} R_{a, b}^{(i, j)(k, l)}+B_{k l} R_{a, b-8}^{(i, j)(k, l)}+C_{k l} R_{a-8, b}^{(i, j)(k, l)}+D_{k l} R_{a-8, b-8}^{(i, j)(k, l)}\right]
\tag{4}
\]</span> 由公式<span class="math inline">\((4)\)</span>我们可知<span class="math inline">\(u\)</span>在<span class="math inline">\((a,b)\)</span>的变化，不见影响<span class="math inline">\(\mathcal{A}\)</span>区域的<span class="math inline">\(8 × 8\)</span>矩阵每个像素点<span class="math inline">\((i,j)\)</span>，还会影响其他三个相邻区域的<span class="math inline">\(\mathrm{B}_{\mathrm{k} 1}, \mathrm{C}_{\mathrm{k} 1}, \mathrm{D}_{\mathrm{kl}}\)</span>三个8x8矩阵的DCT系数。由此我们可以通过两个坐标准确定位一个像素点：<span class="math inline">\((k,l)\)</span>确定了<span class="math inline">\(8 × 8\)</span>矩阵的位置，<span class="math inline">\((a,b)\)</span>确定了<span class="math inline">\(8 × 8\)</span>矩阵里元素的相对位置，因此我们可以准确定义一个二维矩阵<span class="math inline">\(\mathrm{U}_{\mathrm{a}, \mathrm{b}}^{(\mathrm{k}, 1)} \in R^{(M-8) / 8 \times(N-8) / 8}\)</span>作为<span class="math inline">\(\mathrm{U}^{(\mathrm{k}, 1)}\)</span>的子矩阵（<span class="math inline">\(\mathcal{G}_{8 \times 8}\)</span>网格中以左上角顶点为参考对象，相对坐标为<span class="math inline">\(a,b\)</span>）。由此，邻接矩阵的关系为： <span class="math display">\[
\begin{split}
\mathrm{U}^{(\mathrm{k}, 1)}=\bigcup_{\mathrm{a}, \mathrm{b}=0}^{7} \mathrm{U}_{\mathrm{a}, \mathrm{b}}^{(\mathrm{k}, 1)} \quad 当(a, b) \neq\left(a^{\prime}, b^{\prime}\right)时,有\mathrm{U}_{\mathrm{a}, \mathrm{b}}^{(\mathrm{k}, 1)} \cap \mathrm{U}_{\mathrm{a}^{\prime}, \mathrm{b}^{\prime}}^{(\mathrm{k}, 1)}
\end{split}
\tag{5}
\]</span> 因此特征向量由<span class="math inline">\(0 \leq \mathrm{k}, 1 \leq 7,0 \leq \mathrm{a}, \mathrm{b} \leq 7\)</span>归一化的直方图构成： <span class="math display">\[
\mathrm{h}_{\mathrm{a}, \mathrm{b}}^{(\mathrm{k} 1 \mathrm{l})}(\mathrm{r})=\frac{1}{\left|\mathrm{U}_{\mathrm{a}, \mathrm{b}}^{(\mathrm{k}, 1)}\right|} \sum_{\mathrm{u} \in \mathrm{U}_{\mathrm{a}, \mathrm{b}}^{(\mathrm{kl})}}\left[\mathrm{Q}_{\mathrm{T}}(|\mathrm{u}| / \mathrm{q})=\mathrm{r}\right]
\tag{6}
\]</span> 其中，<span class="math inline">\(Q_{T}\)</span>质心为<span class="math inline">\(\{0,1, \ldots, \mathrm{T}\}\)</span>的整数，实际上就是每个直方图的bins，<span class="math inline">\(q\)</span>是量化步长，<span class="math inline">\(\left[\mathrm{Q}_{\mathrm{T}}(|\mathrm{u}| / \mathrm{q})=\mathrm{r}\right]\)</span>中的<span class="math inline">\([P]\)</span>是一个判决器，当等式成立时为1，否则为0。</p>
综上，DCTR算法的流程如图:
<div style="text-align: center;">
<figure>
<img src="/2019/05/29/隐写术(三)--JPEG隐写分析特征算法与理论/1559128502282.png" alt="DCTR算法的流程"><figcaption>DCTR算法的流程</figcaption>
</figure>
</div>
<hr>
<h2 id="x20-自适应二维gabor过滤器">0x20 自适应二维Gabor过滤器</h2>
<p>GFR全称Gabor Filter Residual[2]，这里我们把它称为二维Gabor残差过滤器。GFR能够从不同的尺度和方向准确地描述图像纹理和边缘特征，可以从丰富的图像中抽象出统计特征，以此来更有效地反映JPEG图像被嵌入秘密信息后的变化，提高数字图像隐写分析的性能。GFR利用不同尺度和方向的二维Gabor滤波器[3]对解压后的JPEG图像进行分解，然后从图像滤波系数中提取隐写分析特征。其中二维的Gabor过滤器作为本地带通滤波器在空间域和变换域具有一定的最优联合定位的特性，其能够有效地描述图像纹理和边缘特征。相比于利用64个DCT核对图像滤波的DCTR，二维Gabor过滤器可以捕获嵌入变化更多的尺度和方向，所以GFR可以更能利用自适应隐写的特性。</p>
<p>Gabor变换属于短时傅里叶变换（STFT），其在傅里叶变换中加入了高斯窗，实现了空间域和变换域的局部分析。当使用二维Gabor滤波器进行图像处理和分析时，首先对图像进行二维Gabor滤波器滤波，然后对其特征提取、边缘检测、去噪等处理或分析。首先，将输入的图像<span class="math inline">\(I(\mathrm{x},\mathrm{y})\)</span>与二维Gabor函数<span class="math inline">\(\mathrm{g}(\mathrm{x},\mathrm{y})\)</span>卷积，得到一个Gabor特征图<span class="math inline">\(\mathrm{u}(\mathrm{x}, \mathrm{y})\)</span>： <span class="math display">\[
\mathrm{u}(\mathrm{x}, \mathrm{y})=\iint_{\Omega} \mathrm{I}(\xi, \eta) \mathrm{g}(\mathrm{x}-\xi, \mathrm{y}-\eta) \mathrm{d} \xi \mathrm{d}
\tag{7}
\]</span> 其中，<span class="math inline">\((\mathrm{x}, \mathrm{y}) \in \Omega\)</span>，<span class="math inline">\(\Omega\)</span>表示图像像素点集。公式<span class="math inline">\((7)\)</span>中的<span class="math inline">\(\mathrm{g}(\mathrm{x},\mathrm{y})\)</span>函数采用文献[4]的Gabor函数族，它是高斯函数和余弦函数的乘积： <span class="math display">\[
\mathrm{g}_{\lambda, \theta, \phi}(\mathrm{x}, \mathrm{y})=\mathrm{e}^{-\left(\left(\mathrm{x}^{\prime} 2+\gamma^{2} \mathrm{y}^{\prime} 2\right) / 2 \sigma^{2}\right)} \cos \left(2 \pi \frac{\mathrm{x}}{\lambda}+\phi\right)
\tag{8}
\]</span> 其中，<span class="math inline">\(\mathrm{x}^{\prime}=\mathrm{x} \cos \theta+\mathrm{y} \sin \theta, \mathrm{y}^{\prime}=-\mathrm{x} \sin \theta+\mathrm{y} \cos \theta, \sigma=0.56 \lambda, \gamma=0.5\)</span>。σ越小，表示空间分辨率越高，图像滤波系数反应的局部属性在小尺度；反之，意味着空间分辨率越低，反映再图像的大尺度。最后，所以Gabor滤波器均中心化，其所有元素减去核均值，行成高通滤波器。</p>
<p>提取特征时，GFR隐写分析算法的步骤如下：</p>
<ul>
<li>步骤一：将JPEG图像解压缩到空间域，且不将像素值量化为 ，以避免信息丢失。</li>
<li>步骤二：将通过公式<span class="math inline">\((7)\)</span>生成不同尺度和方向的二维Gabor滤波组 ，其过程类似于DCTR过程中的公式<span class="math inline">\((3)\)</span>。</li>
<li>步骤三：将步骤一生成的解压后的JPEG图像与步骤二生成的每个8x8二维Gabor滤波器卷积，滤波后的图像为<span class="math inline">\(\mathbf{U}_{\mathbf{a}, \mathbf{b}}^{\boldsymbol{s}, \mathbf{l}}\)</span>，有：</li>
</ul>
<blockquote>
<ol type="1">
<li><p>根据64个8x8的DCT块，对滤波后的图像<span class="math inline">\(\mathbf{U}^{\mathbf{S}, \mathbf{I}}\)</span>按步长为8进行子采样，得到64个子图像<span class="math inline">\(\mathbf{U}_{\mathbf{a}, \mathbf{b}}^{\boldsymbol{s}, \mathbf{l}}\)</span>；</p></li>
<li><p>对于每个子图像<span class="math inline">\(\mathbf{U}_{\mathbf{a}, \mathbf{b}}^{\boldsymbol{s}, \mathbf{l}}\)</span>，其直方图特征<span class="math inline">\(\mathbf{h}_{\mathbf{a}, \mathbf{b}}^{\mathbf{s . 1}}(x)\)</span>如公式<span class="math inline">\((9)\)</span>： <span class="math display">\[
\mathbf{h}_{\mathbf{a}, \mathbf{b}}^{s .1}(x)=\frac{1}{\left|\mathbf{U}_{\mathbf{a}, \mathbf{b}}^{s .1}\right|} \sum_{u \in \mathbf{U}_{\mathbf{a}, b}^{s .1}}\left[Q_{T}(|u| / q)=x\right]
\tag{9}
\]</span></p></li>
</ol>
<p>​ 式中各项变量的说明，如公式<span class="math inline">\((6)\)</span>所说。</p>
<ol start="3" type="1">
<li>根据文献[4]的方法，这里将64个子图像<span class="math inline">\(\mathbf{U}_{\mathbf{a}, \mathbf{b}}^{\boldsymbol{s}, \mathbf{l}}\)</span>的直方图特征全部合并，得到滤波后图像<span class="math inline">\(\mathbf{U}^{\mathbf{S}, \mathbf{I}}\)</span>的直方图特征<span class="math inline">\(\mathrm{h}^{\mathrm{S}, 1}\)</span>。</li>
</ol>
</blockquote>
<ul>
<li>步骤四：对具有相同参数σ的二维Gabor过滤器过滤后生成的图像，其相应的直方图特征进行对称合并，这一点也与DCTR相似。例如，假设方向参数<span class="math inline">\(\theta=\{0, \pi / 8,2 \pi / 8, \cdots, 6 \pi / 8,7 \pi / 8\}\)</span>，生成的滤波图像的直方图特征<span class="math inline">\(\theta=\pi / 8,7 \pi / 8\)</span>和<span class="math inline">\(\theta=2 \pi / 8,6 \pi / 8\)</span>两两合并。</li>
</ul>
综上，GFR的过程与DCTR过程最大区别在于选取的64个卷积核不一样，GFR更能代表图像的整体纹理特征，其步骤如下图:
<div style="text-align: center;">
<figure>
<img src="/2019/05/29/隐写术(三)--JPEG隐写分析特征算法与理论/1559130220786.png" alt="GFR算法流程"><figcaption>GFR算法流程</figcaption>
</figure>
</div>
<hr>
<h2 id="x30-相位感知投影模型">0x30 相位感知投影模型</h2>
<p>​ 相位感知投影模型（PHARM）[5]使用基于小内核的像素预测器来避免混合具有不同系谱的随机变量，该方法没有是用大量的像素预测器来实现特征的多样化，而是使用了少量的Small-Support线性像素预测器，并采用了与投影空间富模型（PSRM）类似的方式来实现模型的多样化。下面会粗略介绍一下SRM[6]和PSRM[7]来引出PHARM。</p>
<p>​ 假定两个符号<span class="math inline">\(\mathrm{X}, \mathrm{Y} \in\{0, \ldots, 255\}^{\mathrm{n}_{1} \times \mathrm{n}_{2}}\)</span>，分别表示<span class="math inline">\(n_{1} \times n_{2}\)</span>维的灰度Cover图像和灰度Stego载体图像中的二维像素值数组，<span class="math inline">\(n_1,n_2\)</span>均为8的倍数。无论是SRM还是PSRM都是从45个不同的像素预测器估计给定图像的噪声成分开始的。像素预测器分两种类型：线性和非线性。每个线性预测器都是一个由核矩阵<span class="math inline">\(K\)</span>描述的移不变有限脉冲响应线性滤波器。通过将预测图像从原始图像中减去，得到噪声残差<span class="math inline">\(\mathrm{Z}=\left(\mathrm{z}_{\mathrm{k} \mathrm{l}}\right)\)</span>，（<span class="math inline">\(\mathrm{k},\mathrm{l}\)</span>在接下来的公式中表示一个<span class="math inline">\(n_{1} \times n_{2}\)</span>矩阵的索引）它是一个与<span class="math inline">\(X\)</span>的维数相同的矩阵: <span class="math display">\[
\mathrm{Z}=\mathrm{K} * \mathrm{X}-\mathrm{X}
\tag{10}
\]</span> 由此，我们得到了基本的噪声残差<span class="math inline">\(Z\)</span>，其中“<span class="math inline">\(*\)</span>”表示<span class="math inline">\(K\)</span>和<span class="math inline">\(X\)</span> 镜面填充卷积，使得这两个矩阵卷积后的维数保持不变。 举一个最简单的线性残差的例子：$ <em>{}=</em>{, +1}-_{, } <span class="math inline">\(表示邻接横向残差，其预测器\)</span>K = (0   1)$，则表示将像素值估算为水平相邻的像素值。</p>
<p>​ SRM中的非线性预测器通过取两个或两个以上的残差的最小值或最大值来得到的。例如，分别对<span class="math inline">\(X_{i,j}\)</span>像素在水平和垂直方向上预测，得到水平和垂直方向上的残差<span class="math inline">\(\mathbf{Z}^{h}=\left(\mathrm{z}_{\mathrm{kl}}^{(\mathrm{h})}\right), \mathbf{Z}^{(v)}=\left(\mathrm{z}_{\mathrm{kl}}^{(\mathrm{v})}\right)\)</span>: <span class="math display">\[
\begin{aligned} \mathrm{z}_{\mathrm{kl}}^{(\mathrm{h})} &amp;=\mathrm{x}_{\mathrm{k}, \mathrm{l}+1}-\mathrm{x}_{\mathrm{kl}} \\ \mathrm{z}_{\mathrm{kl}}^{(\mathrm{v})} &amp;=\mathrm{x}_{\mathrm{k}+1,\mathrm{l}}-\mathrm{x}_{\mathrm{kl}} \end{aligned}
\tag{11}
\]</span> 则非线性的最值残差如下： <span class="math display">\[
\begin{aligned} \mathrm{z}_{\mathrm{kl}}^{(\mathrm{min})} &amp;=\min \left\{\mathrm{z}_{\mathrm{kl}}^{(\mathrm{h})}, \mathrm{z}_{\mathrm{kl}}^{(\mathrm{v})}\right\} \\ \mathrm{z}_{\mathrm{kl}}^{(\mathrm{max})} &amp;=\max \left\{\mathrm{z}_{\mathrm{kl}}^{(\mathrm{h})}, \mathrm{z}_{\mathrm{kl}}^{(\mathrm{v})}\right\} \end{aligned}
\tag{12}
\]</span> 与SRM通过四个方向来捕获残差的统计特性不同的是，PSRMQ3是用残差投影到多个随机方向的一阶统计量。给定噪声残差<span class="math inline">\(Z\)</span>，这里直接列出量化值的直方图函数[3]： <span class="math display">\[
\begin{aligned}
\mathrm{h}_{\mathrm{j}}^{(\mathrm{i})}&amp;=\left|\left\{(\mathrm{k}, 1)| | \mathrm{p}_{\mathrm{kl}}^{(\mathrm{i})} |=\mathrm{j}+1 / 2\right\}\right|, \mathrm{j} \in\{0,1, \ldots, \mathrm{T}-1\}, \mathrm{i} \in\{1, \ldots, v\}, 线性极差\\
\mathrm{h}_{\mathrm{j}}^{(\mathrm{i})}&amp;=\left|\left\{(\mathrm{k}, 1) | \mathrm{p}_{\mathrm{kl}}^{(\mathrm{i})}=\mathrm{j}+1 / 2\right\}\right|, \mathrm{j} \in\{-\mathrm{T}, \ldots, \mathrm{T}-1\}, \mathrm{i} \in\{1, \ldots, \mathrm{v}\}, 非线性极差
\end{aligned}
\tag{13}
\]</span> 其中，<span class="math inline">\(\mathrm{p}_{\mathrm{kl}}^{(\mathrm{i})} \leftarrow \mathrm{Q}_{\mathrm{T}}\left(\mathrm{p}_{\mathrm{kl}}^{(\mathrm{i})} / \mathrm{q}\right)\)</span>，而<span class="math inline">\(p_{k l}^{(i)}=\mathrm{P}^{(\mathrm{i})} \triangleq \mathrm{Z} * \Pi^{(\mathrm{i})}\)</span>，<span class="math inline">\(\boldsymbol{\Pi}^{(\mathrm{i})}\)</span>是随机矩阵：<span class="math inline">\(\Pi^{(\mathrm{i})} \in \mathrm{R}^{\mathrm{r\times s}}, \mathrm{i} \in\{1, \ldots, v\}\)</span> 。</p>
<p>​ 在PHARM中，仅使用线性（“spam”类）残差和以下7个内核： <span class="math display">\[
\left(\begin{matrix}-1&amp;1\\\end{matrix}\right)\ \ \ \left(\begin{matrix}-1\\1\\\end{matrix}\right)\ \ \ \left(\begin{matrix}1&amp;-3&amp;3&amp;-1\\\end{matrix}\right)\ \ \ \left(\begin{matrix}1\\-3\\3\\-1\\\end{matrix}\right)\ \ \ \left(\begin{matrix}1&amp;1\\-1&amp;-1\\\end{matrix}\right)\ \ \ \left(\begin{matrix}-1&amp;1\\-1&amp;1\\\end{matrix}\right)\ \ \ \left(\begin{matrix}1&amp;-1\\-1&amp;1\\\end{matrix}\right)
\]</span> ​ 这些核使用贪心正向特征选择算法获得最佳互补核，该算法使用下面列出的25个预测核的检测误差的OOB（Out-of-bag）估计，其中下面列出的第一、第二和第三阶内核使用的预测器与面向相应方向的SRM中使用的预测器相同：</p>
<ul>
<li>1 x 2一阶的水平、垂直、主次对角线（4个预测核）；</li>
<li>1 x 3二阶的水平、垂直、主次对角线（4个预测核）；</li>
<li>1 x 4三阶的水平、垂直、主次对角线（4个预测核）；</li>
<li>2 x 2水平 、垂直 、对角线 （主次对角线相同）（3个预测核）；</li>
<li>3 x 3核和它的4个EDGE（2 x 3）版本的核，如SRM（5个预测核）；</li>
<li>5 x 5在SRM中用在SQUARE子模型的核，以及它的4个EDGE（3x5）版本的核（5个预测核）</li>
</ul>
<p>​ 上面6种类型的预测核不需要都使用，在后续提取JPEG图像的PHARM特征时，使用了一阶、二阶和<span class="math inline">\(2 \times 2\)</span>核。</p>
<hr>
<h2 id="x40-总结">0x40 总结</h2>
<p>本章详细介绍了DCTR、GFR、PHARM三种隐写分析算法的原理和具体步骤.</p>
<hr>
<h2 id="x50-参考文献">0x50 参考文献</h2>
<blockquote>
<p>[1] Holub V , Fridrich J . Low-Complexity Features for JPEG Steganalysis Using Undecimated DCT[J]. IEEE Transactions on Information Forensics and Security, 2015, 10(2):219-228.</p>
<p>[2] Song X , Liu F , Yang C , et al. Steganalysis of Adaptive JPEG Steganography Using 2D Gabor Filters[C]// the 3rd ACM Workshop. ACM, 2015</p>
<p>[3] augman J G . Uncertainty relation for resolution in space, spatial frequency, and orientation optimized by two-dimensional visual cortical filters[J]. Journal of the Optical Society of America. A, Optics and image science, 1985, 2(7):1160-1169.</p>
<p>[4] Grigorescu S E , Petkov N , Kruizinga P . Comparison of texture features based on Gabor filters.[J]. IEEE Transactions on Image Processing A Publication of the IEEE Signal Processing Society, 2002, 11(10):1160-7.</p>
<p>[5] Alattar A M , Memon N D , Heitzenrater C D , et al. SPIE Proceedings [SPIE IS&amp;T/SPIE Electronic Imaging - San Francisco, California, United States (Sunday 8 February 2015)] Media Watermarking, Security, and Forensics 2015 - Phase-aware projection model for steganalysis of JPEG images[J]. Proceedings of SPIE - The International Society for Optical Engineering, 2015, 9409:94090T.</p>
<p>[6] Fridrich J , Kodovsky J . Rich Models for Steganalysis of Digital Images[J]. IEEE Transactions on Information Forensics and Security, 2012, 7(3):868---882.</p>
<p>[7] Fridrich J . Statistically undetectable jpeg steganography:dead ends challenges, and opportunities[C]// Workshop on Multimedia &amp; Security. DBLP, 2007.</p>
</blockquote>

      
      
    </div>
    
  </div>
  
    
    <div class="copyright">
        <p><span>本文标题:</span><a href="/2019/05/29/隐写术(三)--JPEG隐写分析特征算法与理论/">隐写术(三)--JPEG隐写分析特征算法与理论</a></p>
        <p><span>文章作者:</span><a href="/" title="访问 killshadow 的个人博客">killshadow</a></p>
        <p><span>发布时间:</span>2019年05月29日 - 20时28分</p>
        <p><span>最后更新:</span>2019年06月04日 - 18时31分</p>
        <p>
            <span>原始链接:</span><a class="post-url" href="/2019/05/29/隐写术(三)--JPEG隐写分析特征算法与理论/" title="隐写术(三)--JPEG隐写分析特征算法与理论">http://www.killshadow.xyz/2019/05/29/隐写术(三)--JPEG隐写分析特征算法与理论/</a>
            <span class="copy-path" data-clipboard-text="原文: http://www.killshadow.xyz/2019/05/29/隐写术(三)--JPEG隐写分析特征算法与理论/　　作者: killshadow" title="点击复制文章链接"><i class="fa fa-clipboard"></i></span>
            <script src="/js/clipboard.min.js"></script>
            <script> var clipboard = new Clipboard('.copy-path'); </script>
        </p>
        <p>
            <span>许可协议:</span><i class="fa fa-creative-commons"></i> <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/3.0/cn/" title="中国大陆 (CC BY-NC-SA 3.0 CN)" target = "_blank">"署名-非商用-相同方式共享 3.0"</a> 转载请保留原文链接及作者。
        </p>
    </div>



<nav id="article-nav">
  
    <a href="/2019/06/04/深度学习理论基础/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption"><</strong>
      <div class="article-nav-title">
        
          深度学习理论基础
        
      </div>
    </a>
  
  
    <a href="/2019/05/29/隐写术(二)--传统数字图像隐写算法/" id="article-nav-older" class="article-nav-link-wrap">
      <div class="article-nav-title">隐写术(二)--传统数字图像隐写算法</div>
      <strong class="article-nav-caption">></strong>
    </a>
  
</nav>

  
</article>

    <div id="toc" class="toc-article">
    <strong class="toc-title">文章目录</strong>
    <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#x00-前言"><span class="toc-number">1.</span> <span class="toc-text">0x00 前言</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#x10-残差图像的离散余弦变换"><span class="toc-number">2.</span> <span class="toc-text">0x10 残差图像的离散余弦变换</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#x20-自适应二维gabor过滤器"><span class="toc-number">3.</span> <span class="toc-text">0x20 自适应二维Gabor过滤器</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#x30-相位感知投影模型"><span class="toc-number">4.</span> <span class="toc-text">0x30 相位感知投影模型</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#x40-总结"><span class="toc-number">5.</span> <span class="toc-text">0x40 总结</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#x50-参考文献"><span class="toc-number">6.</span> <span class="toc-text">0x50 参考文献</span></a></li></ol>
</div>
<input type="button" id="tocButton" value="隐藏目录"  title="点击按钮隐藏或者显示文章目录">

<script src="https://7.url.cn/edu/jslib/comb/require-2.1.6,jquery-1.9.1.min.js"></script>
<script>
    var valueHide = "隐藏目录";
    var valueShow = "显示目录";

    if ($(".left-col").is(":hidden")) {
        $("#tocButton").attr("value", valueShow);
    }
    $("#tocButton").click(function() {
        if ($("#toc").is(":hidden")) {
            $("#tocButton").attr("value", valueHide);
            $("#toc").slideDown(320);
        }
        else {
            $("#tocButton").attr("value", valueShow);
            $("#toc").slideUp(350);
        }
    })
    if ($(".toc").length < 1) {
        $("#toc, #tocButton").hide();
    }
</script>





<div class="bdsharebuttonbox">
	<a href="#" class="fx fa-weibo bds_tsina" data-cmd="tsina" title="分享到新浪微博"></a>
	<a href="#" class="fx fa-weixin bds_weixin" data-cmd="weixin" title="分享到微信"></a>
	<a href="#" class="fx fa-qq bds_sqq" data-cmd="sqq" title="分享到QQ好友"></a>
	<a href="#" class="fx fa-facebook-official bds_fbook" data-cmd="fbook" title="分享到Facebook"></a>
	<a href="#" class="fx fa-twitter bds_twi" data-cmd="twi" title="分享到Twitter"></a>
	<a href="#" class="fx fa-linkedin bds_linkedin" data-cmd="linkedin" title="分享到linkedin"></a>
	<a href="#" class="fx fa-files-o bds_copy" data-cmd="copy" title="分享到复制网址"></a>
</div>
<script>window._bd_share_config={"common":{"bdSnsKey":{},"bdText":"","bdMini":"2","bdMiniList":false,"bdPic":"","bdStyle":"2","bdSize":"24"},"share":{}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];</script>




    



    <div class="scroll" id="post-nav-button">
        
            <a href="/2019/06/04/深度学习理论基础/" title="上一篇: 深度学习理论基础">
                <i class="fa fa-angle-left"></i>
            </a>
        
        <a title="文章列表"><i class="fa fa-bars"></i><i class="fa fa-times"></i></a>
        
            <a href="/2019/05/29/隐写术(二)--传统数字图像隐写算法/" title="下一篇: 隐写术(二)--传统数字图像隐写算法">
                <i class="fa fa-angle-right"></i>
            </a>
        
    </div>
    <ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2019/06/04/深度学习理论基础/">深度学习理论基础</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/05/29/隐写术(三)--JPEG隐写分析特征算法与理论/">隐写术(三)--JPEG隐写分析特征算法与理论</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/05/29/隐写术(二)--传统数字图像隐写算法/">隐写术(二)--传统数字图像隐写算法</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/05/29/隐写术(一)--简介/">隐写术(一)--简介</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/10/24/Ubuntu18.04+8x1080ti爆破环境从零搭建/">Ubuntu18.04+8x1080ti爆破环境从零搭建</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/10/10/1.1-菜鸟学PWN之栈溢出学习/">1.1-菜鸟学PWN之栈溢出学习</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/09/09/NFC开发笔记/">NFC开发笔记</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/06/15/基于主机的卡模拟(HCE)概述/">基于主机的卡模拟(HCE)概述</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/05/10/某aes变种题分析/">某AES变种题分析</a></li></ul>
    <script src="https://7.url.cn/edu/jslib/comb/require-2.1.6,jquery-1.9.1.min.js"></script>
    <script>
        $(".post-list").addClass("toc-article");
        $(".post-list-item a").attr("target","_blank");
        $("#post-nav-button > a:nth-child(2)").click(function() {
            $(".fa-bars, .fa-times").toggle();
            $(".post-list").toggle(300);
            if ($(".toc").length > 0) {
                $("#toc, #tocButton").toggle(200, function() {
                    if ($(".switch-area").is(":visible")) {
                        $("#tocButton").attr("value", valueHide);
                        }
                    })
            }
            else {
            }
        })
    </script>



    <script>
        
    </script>
</div>
      <footer id="footer">
    <div class="outer">
        <div id="footer-info">
            <div class="footer-left">
                &copy; 2019 killshadow
            </div>
            <div class="footer-right">
                <a href="http://hexo.io/" target="_blank">Hexo</a>  Theme <a href="http://bestwing.me" target="_blank">Sw'blog</a> by Swing
            </div>
        </div>
        
            <div class="visit">
                
                    <span id="busuanzi_container_site_pv" style='display:none'>
                        <span id="site-visit" >海贼到访数: 
                            <span id="busuanzi_value_site_uv"></span>
                        </span>
                    </span>
                
                
                    <span>, </span>
                
                
                    <span id="busuanzi_container_page_pv" style='display:none'>
                        <span id="page-visit">本页阅读量: 
                            <span id="busuanzi_value_page_pv"></span>
                        </span>
                    </span>
                
            </div>
        
    </div>
</footer>

    </div>
    <script src="https://7.url.cn/edu/jslib/comb/require-2.1.6,jquery-1.9.1.min.js"></script>
<script src="/js/main.js"></script>

    <script>
        $(document).ready(function() {
            var backgroundnum = 96;
            var backgroundimg = "url(/background/bg-x.jpg)".replace(/x/gi, Math.ceil(Math.random() * backgroundnum));
            $("#mobile-nav").css({"background-image": backgroundimg,"background-size": "cover","background-position": "center"});
            $(".left-col").css({"background-image": backgroundimg,"background-size": "cover","background-position": "center"});
        })
    </script>





<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
        processEscapes: true,
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    }
});

MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';                 
    }       
});
</script>

<script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


<div class="scroll" id="scroll">
    <a href="#"><i class="fa fa-arrow-up"></i></a>
    <a href="#comments"><i class="fa fa-comments-o"></i></a>
    <a href="#footer"><i class="fa fa-arrow-down"></i></a>
</div>
<script>
    $(document).ready(function() {
        if ($("#comments").length < 1) {
            $("#scroll > a:nth-child(2)").hide();
        };
    })
</script>

<script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js">
</script>

  <script language="javascript">
    $(function() {
        $("a[title]").each(function() {
            var a = $(this);
            var title = a.attr('title');
            if (title == undefined || title == "") return;
            a.data('title', title).removeAttr('title').hover(

            function() {
                var offset = a.offset();
                $("<div id=\"anchortitlecontainer\"></div>").appendTo($("body")).html(title).css({
                    top: offset.top - a.outerHeight() - 15,
                    left: offset.left + a.outerWidth()/2 + 1
                }).fadeIn(function() {
                    var pop = $(this);
                    setTimeout(function() {
                        pop.remove();
                    }, pop.text().length * 800);
                });
            }, function() {
                $("#anchortitlecontainer").remove();
            });
        });
    });
</script>


    <script type="text/javascript">
      window.onload = function(){
        document.getElementById("search").onclick = function(){
            console.log("search")
            search();
        }
      }
      function search(){
        (function(w,d,t,u,n,s,e){w['SwiftypeObject']=n;w[n]=w[n]||function(){
        (w[n].q=w[n].q||[]).push(arguments);};s=d.createElement(t);
        e=d.getElementsByTagName(t)[0];s.async=1;s.src=u;e.parentNode.insertBefore(s,e);
        })(window,document,'script','//s.swiftypecdn.com/install/v2/st.js','_st');

        _st('install','A1Pz-LKMXbrzcFg2FWi6','2.0.0');
      }
    </script>

  </div><!-- hexo-inject:begin --><!-- Begin: Injected MathJax -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config("");
</script>

<script type="text/x-mathjax-config">
  MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
      all[i].SourceElement().parentNode.className += ' has-jax';
    }
  });
</script>

<script type="text/javascript" src="">
</script>
<!-- End: Injected MathJax -->
<!-- hexo-inject:end -->
</body>
</html>